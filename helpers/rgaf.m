function mrga = rgaf(ta1,ta2,debug)
mm = zeros(2,2);
L = 0.127;
M = 0.065;
Jp = 8.74e-5;
Ja = Jp ; %+ 70^2 *  2.087e-3;

mm(1,1) = Ja + M*(L*cos(ta1) - (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) + (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)))*(L*cos(ta1) - (cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(4*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)) + (cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) - angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2))) + M*(L*cos(ta1) - (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)))*(L*cos(ta1) - (cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2))) + (L^2*M*cos(ta1)^2)/4 + (L^2*M*sin(ta1)^2)/4 - M*(L*sin(ta1) - (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) + (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)))*(- L*sin(ta1) + (sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) - angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)) + (sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(4*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2))) + M*(L*sin(ta1) - (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)))*(L*sin(ta1) - (sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2))) + (Jp*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2)))^2)/(8*L^2*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
mm(1,2) =  - M*((sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) - (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)))*(- L*sin(ta1) + (sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) - angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)) + (sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(4*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2))) + M*((cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) - (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)))*(L*cos(ta1) - (cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(4*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)) + (cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) - angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2))) + (M*cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2)))*(L*cos(ta1) - (cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) + (M*sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2)))*(L*sin(ta1) - (sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) - (Jp*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*L^2*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
mm(2,1) =  M*((sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) - angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)) + (sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(4*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)))*(L*sin(ta1) - (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) + (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))) + M*((cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(4*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)) - (cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) - angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)))*(L*cos(ta1) - (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) + (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))) + (M*cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2)))*(L*cos(ta1) - (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)) + (M*sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2)))*(L*sin(ta1) - (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)) - (Jp*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*L^2*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) ;
mm(2,2) = Ja + M*((cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) - (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)))*((cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(4*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)) - (cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) - angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2))) + (L^2*M*cos(ta2)^2)/4 + M*((sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) - angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)) + (sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(4*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)))*((sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) - (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))) + (L^2*M*sin(ta2)^2)/4 + (Jp*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2)))^2)/(8*L^2*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) + (M*cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*cos(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2)))^2)/(64*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) + (M*sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*sin(conj(acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L))) + angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2)))^2)/(64*conj((1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2))*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
crossc = inv(mm);


 if debug
     mm
   crossc
 end
 mrga = mm(1,1)*mm(2,2)/det(mm);

% mrga = crossc(1,1)*crossc(2,2)/det(crossc);

% jac(1,1) = - L * sin(ta1)/2;
% jac(2,1) = + L * cos(ta1)/2;
% jac(3,1) = 1;
% jac(4,1) = - L*sin(ta1) + (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(5,1) = L*cos(ta1) - (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(6,1) = -(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2)))/(4*L*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(7,1) = - L*sin(ta1) + (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) - (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(8,1) = L*cos(ta1) - (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) + (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(9,1) = (2*L^2*sin(ta1)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta1)*(sin(ta1) - sin(ta2)))/(4*L*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(10,1) = 0;
% jac(11,1) = 0;
% jac(12,1) = 0;
% 
% jac(1,2) = 0;
% jac(2,2) = 0;
% jac(3,2) = 0;
% jac(4,2) = -(sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(5,2) = (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)); 
% jac(6,2) = (2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2)))/(4*L*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(7,2) = - (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) + (sin(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(8,2) = (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) + acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(4*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2)) - (cos(angle(L*(sin(ta1) - sin(ta2))*(- 1 - 1i)) - acos((L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)/(2*L)))*(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2))))/(8*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(9,2) = -(2*L^2*sin(ta2)*(cos(ta2) - cos(ta1) + 2) + 2*L^2*cos(ta2)*(sin(ta1) - sin(ta2)))/(4*L*(L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)^(1/2)*(1 - (L^2*(cos(ta2) - cos(ta1) + 2)^2 + L^2*(sin(ta1) - sin(ta2))^2)/(4*L^2))^(1/2));
% jac(10,2) = - L * sin(ta2)/2;
% jac(11,2) = + L * cos(ta2)/2;
% jac(12,2) = 1;

end

